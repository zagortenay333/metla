import "%stdlib/linux";

fn print (str: Slice(U8)) {
    linux.write(linux.stdout, str.data, str.count);
}

fn println (str: Slice(U8)) {
    print(str);
    print("\n");
}

macro iter_range (it: $, i: U64, n: U64, body: $) {
    var idx = i;
    while idx < n {
        embed: (refs=(`it=idx), add_return_backticks) body;
        idx += 1;
    }
}

macro iter_slice (it: $, arr: ~Slice($T), body: $) {
    iter_range: (i, 0, arr~.count) {
        var elem = (arr~.data + i*.sizeof(T))~;
        embed: (refs=(`it=elem), add_return_backticks) body;
    }
}

var z: Slice(U8) = "asdf";
fn: #ir0 main {
        println(z);
}
